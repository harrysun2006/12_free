function initUI(a){$("#job_type").children().remove();$("#job_status").children().remove();$("#job_type").addOptions(a["job.types"],{value:"code",text:"text"});$("#job_status").addOptions(a["job.status"],{value:"code",text:"text"});show(a)}function show(c){var a=c.jobs;var b;$("#total").text("Total:"+a.length+"条记录!");$("#data").jqGrid({datatype:"local",height:"auto",colNames:["ID","时间","提案部门","提案者","提案类型","主题","状态","等级","得分"],colModel:[{name:"id",hidden:true},{name:"reqTime",index:"reqTime",formatter:"date",width:120,sortable:false,align:"center"},{name:"dept1",width:80,sortable:false},{name:"requester",width:100,sortable:false},{name:"cat",width:80,sortable:false},{name:"title",width:293,sortable:false},{name:"#statusText",width:100,sortable:false,align:"center"},{name:"#rank",width:60,sortable:false},{name:"#score",width:60,sortable:false},],loadui:true,multiselect:false,ondblClickRow:openRow,scroll:false,scrollOffset:0});IDS_JOB.setTypes(c["job.types"]);IDS_JOB.setStatus(c["job.status"]);for(b=0;b<a.length;b++){IDS_JOB.initJob(a[b]);$("#data").addRowData(b+1,a[b])}}function openRow(d,h,a,c){var g=$("#data").getRowData(d);var b=$.toJSON({id:g.id});var e=function(f){openJob(d,f)};$.ajax({type:"POST",contentType:"application/json",url:IDS_CONTEXT_PATH+"/job/open_job",data:b,dataType:"json",success:e,error:function(){ajaxError(arguments,this)}})}function openJob(a,b){$("#job_list").hide();var c={"#onJobSave":function(d){IDS_JOB.closeAll();$("#job_list").show();$("#data").setRowData(a,d)},"#onJobDelete":function(d){IDS_JOB.closeAll();$("#job_list").show();$("#data").delRowData(a)},"#onJobReturn":function(){$("#job_list").show()},"#onActReturn":function(){$("#job_list").show()}};IDS_JOB.openJob(b,c)}$(function(){initMenu(2);var a=$.toJSON({});$.ajax({type:"POST",contentType:"application/json",data:a,dataType:"json",url:IDS_CONTEXT_PATH+"/job/query_job",success:function(b){initUI(b)},error:function(){ajaxError(arguments,this)}})});